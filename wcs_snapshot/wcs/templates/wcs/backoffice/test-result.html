{% extends "wcs/backoffice.html" %}
{% load i18n %}

{% block appbar-title %}{% trans "Result" %} #{{ test_results.id }}{% endblock %}

{% block appbar-actions %}
  <a href="../run">{% trans "Run tests again" %}</a>
{% endblock %}

{% block body %}
  <div class="section">
    <h3>{% trans "Details" %}</h3>
    <div>
      <ul>
        <li>{% trans "Started by:" %} {{ test_results.reason }}</li>
        <li>{% trans "Date:" %} {{ test_results.timestamp }}</li>
        {% if test_results.coverage %}
          <li>
            {% trans "Fields coverage:" %} {{ test_results.coverage.percent_fields }}%
            (<a href="fields-coverage">{% trans "details" %}</a>)
          </li>
          {% if test_results.coverage.percent_workflow %}
            <li>
              {% trans "Workflow coverage:" %} {{ test_results.coverage.percent_workflow }}%
              (<a href="workflow-coverage">{% trans "details" %}</a>)
            </li>
          {% endif %}
        {% endif %}
      </ul>
    </div>
  </div>
  <div class="section">
    <h3>Result</h3>
    <div>
      <table class="main">
        <thead>
          <th>{% trans "Name" %}</th>
          <th>{% trans "Result" %}</th>
          <th>{% trans "Inspect" %}</th>
          <th>{% trans "Details" %}</th>
        </thead>
        <tbody>
          {% for result in test_results.results %}
            <tr>
              <td class="name">
                {% if result.testdef %}
                  <a href="{{ result.testdef.get_admin_url }}">{{ result.test_name }}</a>
                {% else %}
                  {{ result.test_name }}
                {% endif %}
              </td>
              <td>{% firstof result.error _("Success!") %}</td>
              <td>
                {% if result.testdef and result.formdata_id %}
                  <a href="{{ result.id }}/inspect">{% trans "Display inspect" %}</a>
                {% endif %}
              </td>
              <td>
                {% if result.has_details %}
                  <a rel="popup" data-selector="div.section" href="{{ result.id }}/">{% trans "Display details" %}</a>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
