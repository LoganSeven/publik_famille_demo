{% load i18n %}
{% if document_model == 'full' and lines_by_user_for_details %}
  <div class="page_break"></div>
  <h1>{% trans "Detail of service days" %}</h1>
  <table id="invoice-lines-details">
    <tbody>
      {% for user, lines in lines_by_user_for_details %}
        <tr class="line-user-separator"><td colspan="5"></td></tr>
        <tr><td colspan="2" class="user-name">{% with line=lines|first %}{{ line.user_name }}{% endwith %}</td></tr>
        <tr>
          <th class="description">{% trans "Services" %}</th>
          <th class="details">{% trans "Details" %}</th>
        </tr>
        {% for line in lines %}
          {% ifchanged line.activity_label %}
            {% if line.activity_label or not forloop.first %}
              <tr><td colspan="2" class="activity"><i>{{ line.activity_label|default:"&nbsp;" }}</i></td></tr>
            {% endif %}
          {% endifchanged %}
          <tr>
            <td class="description">
              {{ line.label }}
            </td>
            <td class="details">
              {% if not line.details.partial_bookings %}
                {% if line.details.check_type_label %}
                  {{ line.details.check_type_label }}
                {% elif line.details.status == 'absence' %}
                  {% trans "Absence" %}
                {% endif %}
              {% endif %}
              {{ line.description }}
            </td>
          </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>
{% endif %}
